class QQEmotionParser{constructor(e={}){this.defaults={baseUrl:"https://qzonestyle.gtimg.cn/qzone/em/",className:"qq-emotion",size:24,altFormat:"[表情{id}]",enableTooltip:!0,onError:null},this.config={...this.defaults,...e},this.emotionRegex=/\[em\]e(\d+)\[\/em\]/gi}parse(e,t={}){if(!e||"string"!=typeof e)return e;let i={...this.config,...t};return e.replace(this.emotionRegex,(e,t)=>{var t=t.trim(),r=i.altFormat.replace("{id}",t),o=i.baseUrl+`e${t}.gif`,t=i.enableTooltip?`data-emotion-id="${t}" title="${r}"`:"";return`<img src="${o}" 
                   alt="${r}"
                   class="${i.className}"
                   ${t}
                   style="width:${i.size}px; height:${i.size}px; 
                          vertical-align: middle; display: inline-block;
                          margin: 0 2px;">`})}parseElement(e,r={}){e="string"==typeof e?document.querySelectorAll(e):[e];e.forEach(e=>{var t;"INPUT"===e.tagName||"TEXTAREA"===e.tagName?e.value=this.parse(e.value,r):e.hasAttribute("data-emotion-content")?(t=e.getAttribute("data-emotion-content"),e.setAttribute("data-emotion-content",this.parse(t,r))):e.innerHTML=this.parse(e.innerHTML,r)}),this._bindErrorHandling(e,r)}parseBatch(e,t={}){return e.map(e=>this.parse(e,t))}safeParse(e){e=e,(t=document.createElement("div")).textContent=e;var t,e=t.innerHTML;return this.parse(e,{onError:(e,t)=>{e.outerHTML=`[表情${t}]`}})}extractEmotionIds(e){for(var t,r=[];null!==(t=this.emotionRegex.exec(e));)r.push(t[1]);return this.emotionRegex.lastIndex=0,[...new Set(r)]}_bindErrorHandling(e,t){let r={...this.config,...t};e.forEach(e=>{e.querySelectorAll("."+r.className).forEach(e=>{e.onerror=()=>{r.onError&&"function"==typeof r.onError?r.onError(e,e.dataset.emotionId):e.outerHTML=e.alt}})})}setConfig(e){this.config={...this.config,...e}}resetConfig(){this.config={...this.defaults}}}"undefined"!=typeof module&&module.exports?module.exports=QQEmotionParser:"function"==typeof define&&define.amd?define([],()=>QQEmotionParser):window.QQEmotionParser=QQEmotionParser;